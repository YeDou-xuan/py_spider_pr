# MySQL数据库查询工具使用说明

## 功能特点

这是一个专为基金数据分析设计的MySQL数据库查询工具，具有以下功能：

### 核心功能
- **数据库连接管理**：支持MySQL数据库连接和断开
- **SQL查询执行**：支持各种SQL语句的执行和结果显示
- **查询模板**：提供常用查询模板，快速生成SQL语句
- **查询历史**：自动保存查询历史，支持快速重用
- **表管理**：查看数据库表列表和表结构
- **结果导出**：支持CSV和Excel格式导出
- **数据复制**：支持将查询结果复制到剪贴板

### 界面布局
- **菜单栏**：文件、工具、帮助菜单
- **连接区域**：数据库连接参数设置
- **查询标签页**：SQL查询和结果显示
- **表管理标签页**：数据库表管理和结构查看

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 1. 启动程序
```bash
python 数据库查询页面设计.py
```

### 2. 连接数据库
1. 在连接区域输入数据库信息：
   - 主机：localhost
   - 用户名：root
   - 密码：liu@423615
   - 数据库名：spider_database
2. 点击"连接数据库"按钮

### 3. 执行查询
1. 在SQL查询区域输入SQL语句
2. 或点击查询模板按钮快速插入常用查询
3. 点击"执行查询"按钮

### 4. 查看结果
- 查询结果会显示在下方的表格中
- 可以调整列宽以更好地查看数据
- 支持滚动查看大量数据

### 5. 导出数据
- 点击"导出CSV"或"导出Excel"按钮
- 选择保存位置和文件名
- 数据将以表格形式导出

### 6. 表管理
- 切换到"表管理"标签页
- 查看数据库中的所有表
- 点击表名查看表结构

## 查询模板

程序提供了以下常用查询模板：

1. **查看所有表**：`SHOW TABLES;`
2. **查看表结构**：`DESCRIBE dayfund_spider_data;`
3. **查看前10条记录**：`SELECT * FROM dayfund_spider_data LIMIT 10;`
4. **统计记录数**：`SELECT COUNT(*) as 总记录数 FROM dayfund_spider_data;`
5. **按日增长排序**：`SELECT \`基金名称\`, \`日增长(%)\` FROM dayfund_spider_data ORDER BY \`日增长(%)\` DESC LIMIT 10;`
6. **按近1年排序**：`SELECT \`基金名称\`, \`近1年(%)\` FROM dayfund_spider_data ORDER BY \`近1年(%)\` DESC LIMIT 10;`
7. **按近1周排序**：`SELECT \`基金名称\`, \`近1周(%)\` FROM dayfund_spider_data ORDER BY \`近1周(%)\` DESC LIMIT 10;`
8. **按近1月排序**：`SELECT \`基金名称\`, \`近1月(%)\` FROM dayfund_spider_data ORDER BY \`近1月(%)\` DESC LIMIT 10;`
9. **查看正收益基金**：`SELECT \`基金名称\`, \`日增长(%)\`, \`近1周(%)\`, \`近1月(%)\` FROM dayfund_spider_data WHERE \`日增长(%)\` > 0 ORDER BY \`日增长(%)\` DESC LIMIT 20;`
10. **查看负收益基金**：`SELECT \`基金名称\`, \`日增长(%)\`, \`近1周(%)\`, \`近1月(%)\` FROM dayfund_spider_data WHERE \`日增长(%)\` < 0 ORDER BY \`日增长(%)\` ASC LIMIT 20;`

## 基金数据分析示例

### 查看基金排行榜
```sql
-- 按日增长排序的前10名基金
SELECT `基金名称`, `基金代码`, `日增长(%)`, `近1周(%)`, `近1月(%)` 
FROM dayfund_spider_data 
ORDER BY `日增长(%)` DESC 
LIMIT 10;
```

### 查看表现最好的基金
```sql
-- 近1年表现最好的基金
SELECT `基金名称`, `基金代码`, `近1年(%)`, `近2年(%)`, `近3年(%)` 
FROM dayfund_spider_data 
WHERE `近1年(%)` IS NOT NULL 
ORDER BY `近1年(%)` DESC 
LIMIT 20;
```

### 统计分析
```sql
-- 各时间段的平均收益率
SELECT 
    AVG(`日增长(%)`) as 平均日增长,
    AVG(`近1周(%)`) as 平均近1周,
    AVG(`近1月(%)`) as 平均近1月,
    AVG(`近1年(%)`) as 平均近1年
FROM dayfund_spider_data;
```

### 条件查询示例
```sql
-- 查询日增长超过5%的基金
SELECT `基金名称`, `基金代码`, `日增长(%)`, `近1周(%)`, `近1月(%)`
FROM dayfund_spider_data 
WHERE `日增长(%)` > 5.0 
ORDER BY `日增长(%)` DESC;

-- 查询近1年收益在10%-20%之间的基金
SELECT `基金名称`, `基金代码`, `近1年(%)`, `近2年(%)`, `近3年(%)`
FROM dayfund_spider_data 
WHERE `近1年(%)` BETWEEN 10.0 AND 20.0 
ORDER BY `近1年(%)` DESC;
```

## 注意事项

1. **数据库连接**：确保MySQL服务正在运行，数据库连接参数正确
2. **字段名引用**：由于数据库字段名包含中文和特殊字符（如`%`、`()`），在SQL查询中必须使用反引号（`）包围字段名，例如：`\`基金名称\`、\`日增长(%)\``
3. **查询性能**：对于大量数据的查询，建议使用LIMIT限制结果数量
4. **数据导出**：导出大量数据时可能需要较长时间，请耐心等待
5. **错误处理**：程序会显示详细的错误信息，请根据提示解决问题
6. **中文查询**：支持中文字段名和表名，但需要正确使用反引号引用

## 技术特点

- 使用PyQt6构建现代化界面
- 支持中文显示和输入
- 异步查询执行，避免界面卡顿
- 完善的错误处理和用户反馈
- 支持多种数据导出格式

## 版本信息

- 版本：v2.0
- 适用：基金数据爬虫项目
- 数据库：MySQL 5.7+
- Python：3.8+
