## 基金数据采集与可视化查询工具

### 项目简介
- 目标：爬取 dayfund.cn 当日基金数据，清洗后入库 MySQL，并通过桌面 GUI 进行查询、导出与分析。
- 组成：数据采集脚本 `爬虫数据入库.py` + 桌面查询工具 `数据库查询页面设计.py`。

### 功能特性
- 数据采集：并发抓取分页数据，解析表格，随机延时降低反爬。
- 数据清洗：百分比去符号转浮点，缺失值归一化，去重，保留基金代码前导零。
- 数据入库：`SQLAlchemy + PyMySQL` 建表与入库，推荐以追加方式写入。
- 查询工具（PyQt6）：数据库连接、SQL 查询、表结构查看、模板查询、结果导出（CSV/Excel）、复制到剪贴板。
- 现代化界面：浅色/深色主题、QSS 风格、表格排序斑马纹、SQL 语法高亮。

### 目录结构
```
├─ 爬虫数据入库.py           # 采集、清洗、入库
├─ 数据库查询页面设计.py       # 桌面 GUI 查询工具
├─ requirements.txt          # 依赖列表
├─ TEXT.py / TEXT.ui         # 示例 UI
├─ 数据库查询工具使用说明.md     # 使用说明（可选）
└─ 字段名快速参考.md           # 字段参考（可选）
```

### 环境依赖
请先安装依赖（建议 Python 3.10+，但3.13版本暂时无法安装PyQt6 -tools）：
```bash
pip install -r requirements.txt
```

如缺少以下库，请在 `requirements.txt` 中加入并安装：
```
requests
beautifulsoup4
lxml
SQLAlchemy
pymysql
openpyxl
```

### 数据库准备
- MySQL 本地或远程实例（默认：`localhost:3306`，数据库名：`spider_database`）。
- 表：运行脚本时会自动建表 `dayfund_spider_data`，包含：
  - 主键 `id`、时间戳 `created_at`
  - 业务列：`序号`、`基金代码`、`基金名称`、`日增长(%)`、`近1周(%)`、`近1月(%)`、`近1季(%)`、`近半年(%)`、`今年来(%)`、`近1年(%)`、`近2年(%)`、`近3年(%)`

### 使用步骤
1.运行采集入库（默认抓取前 5 页）：
```bash
python 爬虫数据入库.py
```
2.启动桌面查询工具：
```bash
python 数据库查询页面设计.py
```
3.在 GUI 中：
- 配置主机、用户名、密码、数据库名，点击“连接数据库”。
- 选择“查询模板”或输入自定义 SQL，点击“执行查询”。
- 可将结果导出为 CSV/Excel 或复制到剪贴板。
- 菜单“外观”可切换浅色/深色主题。

### 常见问题
- Qt 样式报错 Unknown property：Qt QSS 不支持部分 Web CSS 属性（如 `transform`），已替换为等效按压背景色。
- 导入报错：若提示找不到 `SQLAlchemy/lxml` 等，请补充到 `requirements.txt` 并重新安装。
- 基金代码前导零丢失：表结构中 `基金代码` 使用 `VARCHAR(20)`，并在清洗阶段以字符串处理。

### 可扩展方向
- 增量入库与唯一约束，避免重复数据。
- `.env` 管理数据库/并发参数，区分开发与生产环境。
- 本地 CSV 备份与断点续传。
- 增加指标可视化（图表）。


